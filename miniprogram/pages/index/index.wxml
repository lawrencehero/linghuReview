<!--index.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
  <view class="header primary-bg">
    <view class="user-info">
      <view class="avatar-placeholder">
        <text class="avatar-text">{{userInfo.nickName ? userInfo.nickName.charAt(0) : 'ç”¨'}}</text>
      </view>
      <view class="user-details">
        <text class="user-name">{{userInfo.nickName || 'çµç‹ç”¨æˆ·'}}</text>
        <text class="user-level">Lv.{{userLevel}} å¤ç›˜è¾¾äºº</text>
      </view>
    </view>
    <view class="notification-btn" bindtap="onNotificationTap">
      <text class="icon">ğŸ””</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ•°æ® -->
  <view class="stats-section">
    <view class="stats-grid">
      <view class="stat-card card fade-in">
        <text class="stat-number">{{stats.continuousDays}}</text>
        <text class="stat-label">è¿ç»­å¤©æ•°</text>
      </view>
      <view class="stat-card card fade-in">
        <text class="stat-number">{{stats.completionRate}}%</text>
        <text class="stat-label">å®Œæˆç‡</text>
      </view>
    </view>

    <!-- è¿›åº¦æ¡ -->
    <view class="progress-card card fade-in">
      <view class="progress-header">
        <text class="progress-title">æœ¬å‘¨å¤ç›˜è¿›åº¦</text>
        <text class="progress-percentage">{{weekProgress.completed}}/{{weekProgress.total}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{weekProgress.percentage}}%"></view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <view class="action-btn card scale-in" bindtap="onCreateReview">
      <text class="action-icon">ğŸ“</text>
      <text class="action-text">å¼€å§‹å¤ç›˜</text>
    </view>
    <view class="action-btn card scale-in" bindtap="onViewStats">
      <text class="action-icon">ğŸ“Š</text>
      <text class="action-text">æŸ¥çœ‹ç»Ÿè®¡</text>
    </view>
  </view>

  <!-- ä»Šæ—¥æé†’ -->
  <view class="reminder-section" wx:if="{{todayReminder}}">
    <view class="reminder-card card fade-in">
      <view class="reminder-header">
        <text class="reminder-icon">ğŸ’¡</text>
        <text class="reminder-title">ä»Šæ—¥æé†’</text>
      </view>
      <text class="reminder-content">{{todayReminder}}</text>
    </view>
  </view>

  <!-- æœ€è¿‘è®°å½• -->
  <view class="recent-section">
    <view class="section-header">
      <text class="section-title">æœ€è¿‘å¤ç›˜</text>
      <text class="more-btn" bindtap="onViewHistory">æŸ¥çœ‹æ›´å¤š</text>
    </view>

    <view class="recent-list">
      <view class="recent-item card fade-in"
            wx:for="{{recentReviews}}"
            wx:key="id"
            bindtap="onViewDetail"
            data-id="{{item.id}}">
        <view class="recent-content">
          <text class="recent-title">{{item.title}}</text>
          <text class="recent-preview">{{item.preview}}</text>
          <view class="recent-meta">
            <text class="recent-time">{{item.timeAgo}}</text>
            <view class="recent-tags">
              <text class="tag" wx:for="{{item.tags}}" wx:for-item="tag" wx:key="*this">{{tag}}</text>
            </view>
          </view>
        </view>
        <text class="recent-arrow">â€º</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{recentReviews.length === 0}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰å¤ç›˜è®°å½•</text>
      <text class="empty-desc">å¼€å§‹ä½ çš„ç¬¬ä¸€æ¬¡å¤ç›˜å§</text>
      <button class="btn-primary mt-20" bindtap="onCreateReview">ç«‹å³å¼€å§‹</button>
    </view>
  </view>

  <!-- æ¯æ—¥ä¸€å¥ -->
  <view class="quote-section">
    <view class="quote-card card fade-in">
      <text class="quote-icon">ğŸ’­</text>
      <text class="quote-content">{{dailyQuote.content}}</text>
      <text class="quote-author">â€”â€” {{dailyQuote.author}}</text>
    </view>
  </view>
</view>