<!--create.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-left">
      <button class="back-btn" bindtap="onBack">â€¹</button>
      <text class="header-title">åˆ›å»ºå¤ç›˜</text>
    </view>
    <button class="save-btn {{canSave ? 'active' : ''}}" bindtap="onSave">ä¿å­˜</button>
  </view>

  <!-- å¤ç›˜ç±»å‹é€‰æ‹© -->
  <view class="type-section">
    <view class="section-title">å¤ç›˜ç±»å‹</view>
    <view class="type-tabs">
      <button class="type-tab {{reviewType === 'daily' ? 'active' : ''}}" 
              bindtap="onTypeChange" data-type="daily">æ¯æ—¥å¤ç›˜</button>
      <button class="type-tab {{reviewType === 'weekly' ? 'active' : ''}}" 
              bindtap="onTypeChange" data-type="weekly">æ¯å‘¨å¤ç›˜</button>
      <button class="type-tab {{reviewType === 'monthly' ? 'active' : ''}}" 
              bindtap="onTypeChange" data-type="monthly">æ¯æœˆå¤ç›˜</button>
      <button class="type-tab {{reviewType === 'project' ? 'active' : ''}}" 
              bindtap="onTypeChange" data-type="project">é¡¹ç›®å¤ç›˜</button>
    </view>
  </view>

  <!-- æ ‡é¢˜è¾“å…¥ -->
  <view class="input-section">
    <view class="section-title">å¤ç›˜æ ‡é¢˜</view>
    <input class="title-input" 
           placeholder="ç»™ä½ çš„å¤ç›˜èµ·ä¸ªæ ‡é¢˜å§..." 
           value="{{title}}"
           bindinput="onTitleInput"
           maxlength="50" />
    <view class="char-count">{{title.length}}/50</view>
  </view>

  <!-- å†…å®¹è¾“å…¥åŒºåŸŸ -->
  <view class="content-section">
    <!-- äº®ç‚¹ä¸æˆå°± -->
    <view class="content-block">
      <view class="block-header">
        <text class="block-icon">âœ¨</text>
        <text class="block-title">ä»Šæ—¥äº®ç‚¹ä¸æˆå°±</text>
      </view>
      <textarea class="content-textarea"
                placeholder="è®°å½•ä»Šå¤©åšå¾—å¥½çš„åœ°æ–¹ã€å–å¾—çš„æˆå°±..."
                value="{{content.highlights}}"
                bindinput="onContentInput"
                data-field="highlights"
                maxlength="1000" />
      <view class="char-count">{{content.highlights.length}}/1000</view>
    </view>

    <!-- é—®é¢˜ä¸æŒ‘æˆ˜ -->
    <view class="content-block">
      <view class="block-header">
        <text class="block-icon">ğŸ¤”</text>
        <text class="block-title">é‡åˆ°çš„é—®é¢˜ä¸æŒ‘æˆ˜</text>
      </view>
      <textarea class="content-textarea"
                placeholder="è®°å½•é‡åˆ°çš„å›°éš¾ã€é—®é¢˜å’ŒæŒ‘æˆ˜..."
                value="{{content.challenges}}"
                bindinput="onContentInput"
                data-field="challenges"
                maxlength="1000" />
      <view class="char-count">{{content.challenges.length}}/1000</view>
    </view>

    <!-- å­¦ä¹ ä¸æ”¶è· -->
    <view class="content-block">
      <view class="block-header">
        <text class="block-icon">ğŸ“š</text>
        <text class="block-title">å­¦ä¹ ä¸æ”¶è·</text>
      </view>
      <textarea class="content-textarea"
                placeholder="ä»Šå¤©å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›æ–°çš„è®¤çŸ¥å’Œæ”¶è·..."
                value="{{content.learnings}}"
                bindinput="onContentInput"
                data-field="learnings"
                maxlength="1000" />
      <view class="char-count">{{content.learnings.length}}/1000</view>
    </view>

    <!-- æ”¹è¿›è®¡åˆ’ -->
    <view class="content-block">
      <view class="block-header">
        <text class="block-icon">ğŸ¯</text>
        <text class="block-title">æ”¹è¿›è®¡åˆ’</text>
      </view>
      <textarea class="content-textarea"
                placeholder="æ˜å¤©æˆ–ä¸‹æ¬¡å¦‚ä½•åšå¾—æ›´å¥½ï¼Ÿå…·ä½“çš„æ”¹è¿›è®¡åˆ’..."
                value="{{content.improvements}}"
                bindinput="onContentInput"
                data-field="improvements"
                maxlength="1000" />
      <view class="char-count">{{content.improvements.length}}/1000</view>
    </view>
  </view>

  <!-- æ ‡ç­¾é€‰æ‹© -->
  <view class="tags-section">
    <view class="section-title">æ·»åŠ æ ‡ç­¾</view>
    <view class="tags-container">
      <view class="preset-tags">
        <button class="tag-btn {{selectedTags.includes(item) ? 'selected' : ''}}"
                wx:for="{{presetTags}}" wx:key="*this"
                bindtap="onTagToggle" data-tag="{{item}}">{{item}}</button>
      </view>
      <view class="custom-tag-input">
        <input class="tag-input" 
               placeholder="è‡ªå®šä¹‰æ ‡ç­¾"
               value="{{customTag}}"
               bindinput="onCustomTagInput"
               bindconfirm="onAddCustomTag" />
        <button class="add-tag-btn" bindtap="onAddCustomTag">+</button>
      </view>
    </view>
    <view class="selected-tags" wx:if="{{selectedTags.length > 0}}">
      <text class="selected-label">å·²é€‰æ‹©ï¼š</text>
      <view class="selected-tag" wx:for="{{selectedTags}}" wx:key="*this">
        <text>{{item}}</text>
        <text class="remove-tag" bindtap="onRemoveTag" data-tag="{{item}}">Ã—</text>
      </view>
    </view>
  </view>

  <!-- å¿ƒæƒ…è¯„åˆ† -->
  <view class="mood-section">
    <view class="section-title">ä»Šæ—¥å¿ƒæƒ…è¯„åˆ†</view>
    <view class="mood-slider">
      <view class="mood-labels">
        <text class="mood-label">ğŸ˜¢</text>
        <text class="mood-label">ğŸ˜</text>
        <text class="mood-label">ğŸ˜Š</text>
        <text class="mood-label">ğŸ˜„</text>
        <text class="mood-label">ğŸ¤©</text>
      </view>
      <slider class="slider" 
              min="1" max="5" step="1" 
              value="{{moodScore}}"
              bindchange="onMoodChange"
              activeColor="#667eea"
              backgroundColor="#f0f0f0" />
      <view class="mood-score">å½“å‰è¯„åˆ†ï¼š{{moodScore}}åˆ†</view>
    </view>
  </view>

  <!-- æ¨¡æ¿é€‰æ‹© -->
  <view class="template-section" wx:if="{{showTemplates}}">
    <view class="section-title">
      <text>é€‰æ‹©æ¨¡æ¿</text>
      <button class="toggle-btn" bindtap="onToggleTemplates">
        {{showTemplates ? 'æ”¶èµ·' : 'å±•å¼€'}}
      </button>
    </view>
    <view class="template-list">
      <view class="template-item" 
            wx:for="{{templates}}" wx:key="id"
            bindtap="onSelectTemplate" data-template="{{item}}">
        <text class="template-name">{{item.name}}</text>
        <text class="template-desc">{{item.description}}</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="onSaveDraft">ä¿å­˜è‰ç¨¿</button>
    <button class="action-btn primary {{canSave ? '' : 'disabled'}}" 
            bindtap="onSave">å‘å¸ƒå¤ç›˜</button>
  </view>
</view>

<!-- æ¨¡æ¿é€‰æ‹©å¼¹çª— -->
<view class="template-modal {{showTemplateModal ? 'active' : ''}}" bindtap="onCloseTemplateModal">
  <view class="template-modal-content" catchtap="">
    <view class="modal-header">
      <text class="modal-title">é€‰æ‹©å¤ç›˜æ¨¡æ¿</text>
      <button class="modal-close" bindtap="onCloseTemplateModal">Ã—</button>
    </view>
    <view class="template-grid">
      <view class="template-card" 
            wx:for="{{allTemplates}}" wx:key="id"
            bindtap="onApplyTemplate" data-template="{{item}}">
        <text class="template-card-name">{{item.name}}</text>
        <text class="template-card-desc">{{item.description}}</text>
        <view class="template-preview">
          <text wx:for="{{item.sections}}" wx:key="*this" wx:for-item="section">
            {{section}}
          </text>
        </view>
      </view>
    </view>
  </view>
</view>

